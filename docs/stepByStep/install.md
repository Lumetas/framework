Это пошаговая инструкция как сделать своё веб приложение используя meract framework. Вероятно тут я буду ссылаться на основной `README` файл.

# Установка
Для начала вам нужно заполучить фреймворк чтобы с ним работать. Сделать это можно двумя способами:
1. Склонировать этот репозиторий.
2. Установить из [packagist.org](https://packagist.org/packages/lumetas/meract)

Установка из репозитория `composer` удобнее и безопаснее поскольку туда попадают только стабильные версии, в тоже время установка из гитхаб даст вам больше новых функций. И это может быть критично. Поскольку фреймворк ещё совсем молодой и развивается быстро. Сравнить обе версии вы можете прочитав README там и там. Это даст вам представление что лучше использовать поскольку все компоненты описаны в README. и если на [packagist](https://packagist.org/packages/lumetas/meract) не описан какой-либо компонент, значит вероятнее всего его там нет. Пока что нет.

И так установка из репозитория:
```
composer create-project lumetas/meract project-name
cd project-name
php mrst init
php mrst migrate
```

Установка из гитхаб:

```
git clone https://github.com/lumetas/meract.git project-name
cd project-name
composer install
php mrst init
php mrst migrate
```
Как видите в обоих случаях вам понадобится composer и установка в обоих случаях не сложная.




# Настройка
Вся настройка производится в файле `config.php`
Выглядит он примерно так:
```
<?php
return [
	"server" => [
		"customServer" => false,
		"host" => "0.0.0.0",
		"port" => 80,
		"initFunction" => function () {
			echo "server started!\n";
		},
        "requestLogger" => new class extends RequestLogger {
			public function handle($rq) {
				echo "test\n";
			}
		}
	],
	"database" => [
		"driver" => "sqlite",
		"sqlite_path" => __DIR__ . "/db.sqlite"
	],
	"storage" => [
		"driver" => null,
		"time" => 20
	],
    "worker" => [
        "enabled" => true,
        "endpoint" => "endpoint",
        "server-callback" => function (string $data): string {
            echo $data."\n";
            return "Понял";
        }
    ]
];
```
Разберём разделы конфига
- `server` это настройки самого сервера.
- `database` настройки подключения к базе данных
- `storage` настройки компонента storage используемый драйвер(null - по умолчанию) и время жизни
- `worker` Система воркеров и очередей.

Теперь разберём каждый пункт подробнее чтобы ниукого не осталось вопросов на тему настройки.
### server
- `customServer` Использовать ли стандартный fpm php если true то использовать если нет, то использовать встроенный сервер.
- `host` Это интерфейс на котором будет запущен сервер
- `port` Порт на котором будет запущен сервер
- `initFunction` Функция вызываемая при старте встроенного сервера(если используется таковой)
- `requestLogger` Логгер запросов, который выводит в консоль информацию о входящих запросах

При использовании fpm `initFunction` и `requestLogger` Не используются. Хост и порт учитываются только при запуске через утилиту командной строки mrst.

### database
не буду разбирать настройку базы данных. Примеры подключения ко всем доступным базам есть в README.

Единственное скажу будьте осторожны с этим пунктом. Можете задавать значения через env или вынести настройку в отдельный файл:
```
"database" => require_once "db_config.php"
```
Чтобы данные базы не утекли.

### worker
- `enabled` Включен ли
- `endpoint` Адрес куда воркер процес будет отправлять сообщения. Он должен быть длинным и не возможным для случайного нахождения пользователями, например: `bznDuMyWjBrbgn9nScHC3tUVaFbmhGeca6Zj4EzF82UNgjaTaGpF9ATFe5cQrk7B`
- `server-callback` Функция выполняемая сервером когда воркер отправил сообщение.


# Запуск
Запустить можно разными способами в зависимости от используемого сервера. А так же используете ли вы apache/nginx
Но в общем случае во время разработки я рекомендую запускать вот так:
```
php mrst serve
```
Команда автоматически подстроится под используемый сервер и запустит ваше приложение с указанными данными (хост,порт). Но есть и другие способы.

В случае fpm, dev-server можно поднять вот так:
```
php -S 0.0.0.0:8000 index.php
```

А в случае встроенного сервера так:
```
php index.php
```


# [NEXT](helloWorld.md)